# 环境配置说明

本项目支持开发环境和测试环境分离，确保开发过程中的代码改动不会影响测试。

## 环境配置

### 开发环境 (Development)
- **用途**: 本地开发使用
- **端口配置**:
  - 前端: `3000`
  - Node.js后端: `5000`
  - Python后端: `8000`
- **网络访问**: 仅限本地访问
- **特点**: 实时热重载，代码改动立即生效

### 测试环境 (Testing)
- **用途**: 别人测试使用
- **端口配置**:
  - 前端: `3001`
  - Node.js后端: `5001`
  - Python后端: `8001`
- **网络访问**: 支持IP地址访问 (`172.26.72.31`)
- **特点**: 代码改动不会影响，适合稳定测试

## 启动方式

### 开发环境启动
```bash
# 启动完整的开发环境（前端+后端）
npm run dev:full

# 或者分别启动
npm run dev          # 前端开发服务器
npm run dev:server   # 后端服务器
```

### 测试环境启动
```bash
# 启动完整的测试环境（前端+后端）
npm run test:full
```

## 访问地址

### 开发环境
- 前端应用: `http://localhost:3000`
- 后端API: `http://localhost:5000`
- 管理面板: `http://localhost:3000/admin`

### 测试环境
- 前端应用: `http://localhost:3001` 或 `http://172.26.72.31:3001`
- 后端API: `http://localhost:5001` 或 `http://172.26.72.31:5001`
- 管理面板: `http://localhost:3001/admin` 或 `http://172.26.72.31:3001/admin`

## 环境变量

### 开发环境
```bash
NODE_ENV=development
PORT=5000
HOST=localhost
```

### 测试环境
```bash
NODE_ENV=testing
PORT=5001
HOST=0.0.0.0
```

## 配置文件

### 环境配置
- `config/environments.js` - 环境配置文件
- 支持动态端口和主机配置
- 自动根据环境选择配置

### Vite配置
- `vite.config.js` - 前端构建配置
- 自动根据环境配置端口和代理

### 后端配置
- `server/index.js` - 后端服务器配置
- 支持环境变量配置端口和主机

## 使用建议

### 开发时
1. 使用 `npm run dev:full` 启动开发环境
2. 在3000端口进行开发
3. 代码改动会实时生效

### 测试时
1. 使用 `npm run test:full` 启动测试环境
2. 在3001端口进行测试
3. 开发代码改动不会影响测试环境

### 部署时
1. 确保测试环境稳定运行
2. 开发环境可以自由修改代码
3. 测试完成后，将稳定代码合并到测试环境

## 注意事项

1. **端口冲突**: 确保不同环境使用不同端口
2. **网络访问**: 测试环境支持IP访问，开发环境仅限本地
3. **数据隔离**: 两个环境使用不同的数据存储
4. **配置同步**: 环境配置文件修改后需要重启服务

## 故障排除

### 端口被占用
```bash
# 查看端口占用情况
lsof -i :3000
lsof -i :3001
lsof -i :5000
lsof -i :5001

# 杀死占用进程
kill -9 <PID>
```

### 环境配置错误
1. 检查 `config/environments.js` 文件
2. 确认环境变量设置正确
3. 重启相关服务

### 网络访问失败
1. 确认测试环境使用 `HOST=0.0.0.0`
2. 检查防火墙设置
3. 验证IP地址配置正确
